%! suppress = MissingImport
%%
%% I/O Prelab (c) 2021-22 Christopher A. Bohn
%%
%% Licensed under the Apache License, Version 2.0 (the "License");
%% you may not use this file except in compliance with the License.
%% You may obtain a copy of the License at
%%     http://www.apache.org/licenses/LICENSE-2.0
%% Unless required by applicable law or agreed to in writing, software
%% distributed under the License is distributed on an "AS IS" BASIS,
%% WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
%% See the License for the specific language governing permissions and
%% limitations under the License.
%%

\input{../../common/assignment.tex}
\input{../../common/semester.tex}
\input{macros.tex}
\input{breadboard-template.tex}

\renewcommand{\labnumber}{\ioprelabnumber}
\renewcommand{\labname}{Physical Assembly of Hardware for I/O Labs}
\renewcommand{\shortlabname}{i/o-prelab}
\renewcommand{\collaborationrules}{\ioprelabcollaboration}
\renewcommand{\duedate}{\ioprelabdue}


\pagelayout
\begin{document}
\labidentifier

In the I/O labs, we will use a microcontroller board with some peripherals.
In this prelab, you will assemble the hardware for the I/O labs.

\section{Obtaining the Hardware} \obtaininghardware

\section{Inventorying the Hardware} \label{sec:inventory} \input{inventory/inventorying-the-hardware}

\vspace{0.5cm}

\section*{Assembling the Class Kit}

    You will assemble the hardware in the following steps.
    \textbf{At various checkpoints, you should pause to have a TA or classmate double-check your work.}
    When you do so, update the \textit{checkpoints.txt} file to indicate who checked your work and when they did so.

    You may want to store your partially- and fully-completed kit in a plastic food container or some other container to prevent jumper wires from being pulled out while in your backpack.

    \textit{
        \textbf{Note:} The following pages include both diagrams and photographs of the assembly.
        The wire colors in the diagrams do not match the wire colors in the assembly.
        The wire colors in the diagrams are coded by the purpose they serve, whereas the wire colors in the photographs are the colors of wires removed from the \rainbow.
    }

\section{Microcontroller and IDE} \input{microcontroller/microcontroller-and-ide.tex}

\section{Direct Input/Output Devices} \input{direct/direct-io.tex}

\section{Matrix Keypad} \input{keypad/matrix-keypad.tex}

\section{Display Module} \input{display/display-module.tex}

\section*{Kit Assembly is Complete}

    You have now finished assembling the class kit (Figure~\ref{fig:complete}).
    In the upcoming I/O labs, you will use the kit to learn about memory-mapped I/O and about handling low-level interrupts.

    \begin{figure}
        \centering
        \subfloat[]{
            \includegraphics[height=0.55\textheight]{fritzing_diagrams/complete}
%            \label{fig:complete-diagram}
        }

        \subfloat[]{
            \includegraphics[height=0.35\textheight]{completed-kit}
%            \label{fig:complete-kit}
        }
        \caption{The fully-assembled class kit.\label{fig:complete}}
    \end{figure}

\section{Turn-in and Grading}

    When you have completed this assignment, upload \textit{checkpoints.txt} to \filesubmission.

    This assignment is worth 1 point, with up to 5 bonus points for helping other students. \\

    Rubric:
    \begin{description}
        \rubricitem{0.5}{You bring your fully-assembled class kit to your lab section the week it is due.}
        \rubricitem{0.5}{You upload the completed \textit{checkpoints.txt} file to \filesubmission.}
        \bonusitem{0.1}{For each checkpoint you verify for fellow students, as reported in their \textit{checkpoints.txt} files;
            maximum of 5.0 bonus points.}
    \end{description}

\section*{Appendix: Breadboard Templates}

    Figure~\ref{fig:templates} is a pair of templates for the Cow Pi circuit (one if your kit has pushbuttons with two leads, and the other if your kit has pushbuttons with four prongs).
    Each dot (\tikz{\draw[white,fill=gray] (0,0) +(0,3pt) circle (1pt);}) represents a breadboard contact point.
    Each dot with a circle (\tikz{\drawtarget{0}{3pt} \draw[white,fill=gray] (0,0) +(0,3pt) circle (1pt);}) is a contact point in which you will insert a jumper lead.
    Attached to most of these circles is the contact point for the other end of the jumper wire (\tikz{\drawlabelledtarget{0}{0}{1}{k64} \draw[white,fill=gray] (0,0) circle (1pt);}).
    The footprints of several components are shown as light-gray outlines;
    resistors (\tikz{\ctikzset{bipoles/resistor/height=0.2}\ctikzset{bipoles/resistor/width=0.3}\draw (0,0) to[R] (1,0)}) and LEDs (\tikz{\ctikzset{bipoles/diode/height=0.2}\ctikzset{bipoles/diode/width=0.2}\draw (0,0) to[led] (1,0)}) are shown using their conventional symbols.
    Squares (\tikz{\draw[white,fill=gray] (0,0) +(2pt,3pt) circle (1pt); \draw (0,0) +(0,1pt) rectangle +(4pt,5pt);}) are where you'll insert component individual pins,
        and rectangles (\tikz{\draw (0,0) +(0,1pt) rectangle +(11pt,5pt); \draw[white,fill=gray] (0,0) +(2pt,3pt) circle (1pt); \draw[white,fill=gray] (0,0) +(5.5pt,3pt) circle (1pt); \draw[white,fill=gray] (0,0) +(9pt,3pt) circle (1pt);}) are where you'll insert components' in-line pins.
    Finally, the four corners (\tikz{\draw[white,fill=gray] (0,0) +(2pt,3pt) circle (1pt); \draw (0,1pt) -- (4pt,5pt); \draw (0,5pt) -- (4pt,1pt);}) are used to align the template on your solderless breadboard.

    \begin{figure}[p]
        \subfloat[Template that uses 2-lead pushbuttons.]{
            \hspace{-.5in}
%            \begin{tikzpicture}[x=.1081in, y=.1088in] % TODO: determine which to use
            \begin{tikzpicture}[x=.1in, y=.1in]
                \drawbreadboard
                \drawnano{1}{3}{Arduino Nano}
                \drawnand{18}{5}
                \drawswitches{27}
                \drawbuttons{37}{2}
                \drawkeypadandtargets{26}
                \drawdisplay{48}
                \drawledcircuit
            \end{tikzpicture}
        }
        \vspace{.5in}
        \subfloat[Template that uses 4-prong pushbuttons.]{
            \hspace{-.5in}
            \begin{tikzpicture}[x=.108in, y=.1081in]  % TODO: determine which to use
                \drawbreadboard
                \drawnano{1}{3}{Arduino Nano}
                \drawnand{18}{5}
                \drawswitches{27}
                \drawbuttons{37}{4}
                \drawkeypadandtargets{26}
                \drawdisplay{48}
                \drawledcircuit
            \end{tikzpicture}
        }
        \caption{Templates to improve accuracy when constructing the Cow Pi circuit on a solderless breadboard.}\label{fig:templates}\addcontentsline{toc}{section}{Breadboard Templates}
    \end{figure}

\end{document}
